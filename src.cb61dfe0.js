parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"BHl8":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var i=function i(s,o,l,a){var r=this;t(this,i),e(this,"resizeCanvas",function(t,e){r.canvas.width=t,r.canvas.height=e}),e(this,"clearBackground",function(){r.displayContext.fillStyle=r.backgroundColor,r.displayContext.fillRect(0,0,r.canvas.width,r.canvas.height)}),e(this,"clearDisplay",function(){r.display=new Array(r.cols*r.rows);for(var t=0;t<r.cols*r.rows;t++)r.display[t]=0}),e(this,"getPixel",function(t,e){var i=t+e*r.cols;return r.display[i]}),e(this,"setPixel",function(t,e,i){t>r.cols?t-=r.cols:t<0&&(t+=r.cols),e>r.rows?e-=r.rows:e<0&&(e+=r.rows);var s=t+e*r.cols;r.display[s]=i}),e(this,"drawPixel",function(t,e){r.displayContext.fillStyle=r.pixelColor,r.displayContext.fillRect(t,e,r.pixelSize,r.pixelSize)}),e(this,"draw",function(){r.clearBackground();for(var t=0;t<r.cols*r.rows;t++){var e=t%r.cols*r.scale,i=Math.floor(t/r.cols)*r.scale;1==r.display[t]&&r.drawPixel(e,i)}}),e(this,"keyDownHandler",function(t){r.keysCurrentlyPressed[r.keypadMap[t.keyCode]]=!0,r.keyPressDetector&&(r.keyPressDetector(r.keypadMap[t.keyCode]),r.keyPressDetector=null)}),e(this,"keyUpHandler",function(t){r.keysCurrentlyPressed[r.keypadMap[t.keyCode]]=!1}),e(this,"createOscillator",function(){r.oscillator=r.audioContext.createOscillator(),r.oscillator.type="sine",r.oscillator.frequency.setValueAtTime(440,r.audioContext.currentTime)}),e(this,"playAudio",function(t){t?null==r.oscillator&&(r.createOscillator(),r.oscillator.connect(r.audioContext.destination),r.oscillator.start()):r.oscillator&&(r.oscillator.stop(),r.oscillator.disconnect(),r.oscillator=null)}),this.canvas=s,this.displayContext=s.getContext("2d"),this.backgroundColor="rgb(0,0,0)",this.pixelColor="rgb(255,255,255)",this.cols=o,this.rows=l,this.scale=a,this.width=this.cols*this.scale,this.height=this.rows*this.scale,this.pixelSize=1*this.scale,this.display=null,this.clearDisplay(),this.resizeCanvas(this.width,this.height),this.clearBackground(),window.addEventListener("keydown",this.keyDownHandler.bind(this),!1),window.addEventListener("keyup",this.keyUpHandler.bind(this),!1),this.keypadMap={49:1,50:2,51:3,52:12,81:4,87:5,69:6,82:13,65:7,83:8,68:9,70:14,90:10,88:0,67:11,86:15},this.keysCurrentlyPressed=[],this.keyPressDetector=null,this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.oscillator=null},s=i;exports.default=s;
},{}],"aWir":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("./io"));function s(e){return e&&e.__esModule?e:{default:e}}function a(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function r(e,s){for(var a=0;a<s.length;a++){var r=s[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,s,a){return s&&r(e.prototype,s),a&&r(e,a),e}function t(e,s,a){return s in e?Object.defineProperty(e,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[s]=a,e}var c=function(){function s(r){var i=this;a(this,s),t(this,"uploadRomToMemory",function(e){for(var s=0;s<i.fonts.length;s++)i.memory[s]=i.fonts[s];for(var a=new Uint8Array(e),r=0;r<a.length;r++)i.memory[512+r]=a[r];console.log("Rom uploaded to memory")}),t(this,"emulatorLoop",function(){for(var e=0;e<10;e++)if(i.isExecuting){var s=i.memory[i.pc]<<8|i.memory[i.pc+1];i.decode(s)}i.isExecuting&&(i.delayTimer>0&&i.delayTimer--,i.soundTimer>0&&i.soundTimer--),i.soundTimer>0?i.io.playAudio(!0):i.io.playAudio(!1),i.io.draw()}),t(this,"decode",function(e){i.pc+=2;var s=(3840&e)>>8,a=(240&e)>>4;switch(61440&e){case 0:switch(e){case 224:i.io.clearDisplay();break;case 238:i.pc=i.stack[--i.sp]}break;case 4096:i.pc=4095&e;break;case 8192:i.stack[i.sp++]=i.pc,i.pc=4095&e;break;case 12288:i.v[s]===(255&e)&&(i.pc+=2);break;case 16384:i.v[s]!=(255&e)&&(i.pc+=2);break;case 20480:i.v[s]===i.v[a]&&(i.pc+=2);break;case 24576:i.v[s]=255&e;break;case 28672:i.v[s]+=255&e;break;case 32768:switch(15&e){case 0:i.v[s]=i.v[a];break;case 1:i.v[s]=i.v[s]|i.v[a];break;case 2:i.v[s]=i.v[s]&i.v[a];break;case 3:i.v[s]=i.v[s]^i.v[a];break;case 4:var r=i.v[s]+i.v[a];i.v[15]=r>255?1:0,i.v[s]=255&r;break;case 5:i.v[s]>i.v[a]?i.v[15]=1:i.v[15]=0,i.v[s]-=i.v[a];break;case 6:1==(1&i.v[s])?i.v[15]=1:i.v[15]=0,i.v[s]>>=1;break;case 7:i.v[a]>i.v[s]?i.v[15]=1:i.v[15]=0,i.v[s]=i.v[a]-i.v[s];break;case 14:1==(128&i.v[s])?i.v[15]=1:i.v[15]=0,i.v[s]*=2;break;default:console.error("Wrong opcode for ALU: "+e)}break;case 36864:i.v[s]!=i.v[a]&&(i.pc+=2);break;case 40960:i.i=4095&e;break;case 45056:i.pc=i.v[0]+(4095&e);break;case 49152:var t=Math.floor(255*Math.random());i.v[s]=255&t&e;break;case 53248:var c=i.v[s],v=i.v[a],o=15&e;i.v[15]=0;for(var h=0;h<o;h++)for(var n=i.memory[i.i+h],k=0;k<8;k++){c=i.v[s]+k,v=i.v[a]+h;var b=n&128>>k,l=i.io.getPixel(c,v);0!=b&&(1==l?(i.io.setPixel(c,v,0),i.v[15]=1):i.io.setPixel(c,v,1))}break;case 57344:switch(255&e){case 158:i.io.keysCurrentlyPressed[i.v[s]]&&(i.pc+=2);break;case 161:i.io.keysCurrentlyPressed[i.v[s]]||(i.pc+=2)}break;case 61440:switch(255&e){case 7:i.v[s]=i.delayTimer;break;case 10:i.isExecuting=!1;i.io.keyPressDetector=function(e){i.v[s]=e,i.isExecuting=!0}.bind(i);break;case 21:i.delayTimer=i.v[s];break;case 24:i.soundTimer=i.v[s];break;case 30:i.i=i.i+i.v[s];break;case 41:i.i=5*i.v[s];break;case 51:i.memory[i.i]=Math.floor(i.v[s]/100),i.memory[i.i+1]=Math.floor(i.v[s]%100/10),i.memory[i.i+2]=Math.floor(i.v[s]%10);break;case 85:for(var u=0;u<=s;u++)i.memory[i.i+u]=i.v[u];i.i=i.i+s+1;break;case 101:for(var m=0;m<=s;m++)i.v[m]=i.memory[i.i+m];i.i=i.i+s+1;break;default:console.error("Wrong opcode for 0xF000: "+e)}break;default:console.error("Wrong opcode: "+e)}}),this.io=new e.default(r,64,32,10),this.memory=new Uint8Array(4096),this.pc=512,this.i=0,this.stack=[],this.sp=0,this.delayTimer=0,this.soundTimer=0,this.v=new Uint8Array(16),this.isExecuting=!0,this.fonts=[240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128]}return i(s,[{key:"decode1",value:function(e){var s=this;this.pc+=2;var a=(3840&e)>>8,r=(240&e)>>4;switch(61440&e){case 0:switch(e){case 224:this.io.clearDisplay();break;case 238:this.pc=this.stack.pop()}break;case 4096:this.pc=4095&e;break;case 8192:this.stack.push(this.pc),this.pc=4095&e;break;case 12288:this.v[a]===(255&e)&&(this.pc+=2);break;case 16384:this.v[a]!=(255&e)&&(this.pc+=2);break;case 20480:this.v[a]===this.v[r]&&(this.pc+=2);break;case 24576:this.v[a]=255&e;break;case 28672:this.v[a]+=255&e;break;case 32768:switch(15&e){case 0:this.v[a]=this.v[r];break;case 1:this.v[a]|=this.v[r];break;case 2:this.v[a]&=this.v[r];break;case 3:this.v[a]^=this.v[r];break;case 4:var i=this.v[a]+=this.v[r];this.v[15]=0,i>255&&(this.v[15]=1),this.v[a]=i;break;case 5:this.v[15]=0,this.v[a]>this.v[r]&&(this.v[15]=1),this.v[a]-=this.v[r];break;case 6:this.v[15]=1&this.v[a],this.v[a]>>=1;break;case 7:this.v[15]=0,this.v[r]>this.v[a]&&(this.v[15]=1),this.v[a]=this.v[r]-this.v[a];break;case 14:this.v[15]=128&this.v[a],this.v[a]<<=1;break;default:throw new Error("BAD OPCODE")}break;case 36864:this.v[a]!=this.v[r]&&(this.pc+=2);break;case 40960:this.index=4095&e;break;case 45056:this.pc=(4095&e)+this.v[0];break;case 49152:var t=Math.floor(255*Math.random());this.v[a]=255&t&e;break;case 53248:var c=this.v[a],v=this.v[r],o=15&e;this.v[15]=0;for(var h=0;h<o;h++)for(var n=this.memory[this.i+h],k=0;k<8;k++){c=this.v[a]+k,v=this.v[r]+h;var b=n&128>>k,l=this.io.getPixel(c,v);0!=b&&(1==l?(this.io.setPixel(c,v,0),this.v[15]=1):this.io.setPixel(c,v,1))}break;case 57344:switch(255&e){case 158:this.io.keysCurrentlyPressed[this.v[a]]&&(this.pc+=2);break;case 161:this.io.keysCurrentlyPressed[this.v[a]]||(this.pc+=2);break;default:throw new Error("BAD OPCODE")}break;case 61440:switch(255&e){case 7:this.v[a]=this.delayTimer;break;case 10:this.isExecuting=!1;this.io.keyPressDetector=function(e){s.v[a]=e,s.isExecuting=!0}.bind(this);break;case 21:this.delayTimer=this.v[a];break;case 24:this.soundTimer=this.v[a];break;case 30:this.i+=this.v[a];break;case 41:this.i=5*this.v[a];break;case 51:this.memory[this.i]=parseInt(this.v[a]/100),this.memory[this.i+1]=parseInt(this.v[a]%100/10),this.memory[this.i+2]=parseInt(this.v[a]%10);break;case 85:for(var u=0;u<=a;u++)this.memory[this.i+u]=this.v[u];break;case 101:for(var m=0;m<=a;m++)this.v[m]=this.memory[this.i+m];break;default:throw new Error("0xF BAD OPCODE "+e)}break;default:throw new Error("BAD OPCODE")}}}]),s}(),v=c;exports.default=v;
},{"./io":"BHl8"}],"Focm":[function(require,module,exports) {
"use strict";var e,t=n(require("./chippy8"));function n(e){return e&&e.__esModule?e:{default:e}}var o=void 0,r=60,a=document.getElementById("canvas"),l=document.getElementById("romFile"),d=document.getElementById("start");function u(){var e=document.getElementById("romFile").files[0],t=new FileReader;t.readAsArrayBuffer(e),t.onloadend=function(e){o=e.target.result,console.log(o.byteLength)}}function i(n){window.cancelAnimationFrame(m),(e=new t.default(a)).uploadRomToMemory(n),m()}function c(){o?i(o):alert("No rom uploaded!")}function m(){setTimeout(function(){requestAnimationFrame(m),e.emulatorLoop()},1e3/r)}a.getContext?(console.log("Welcome to Chip 8 Emulator"),e=new t.default(a)):console.log("Canvas not supported. Try different browser."),l.addEventListener("change",u),d.addEventListener("click",c);
},{"./chippy8":"aWir"}]},{},["Focm"], null)
//# sourceMappingURL=src.cb61dfe0.js.map